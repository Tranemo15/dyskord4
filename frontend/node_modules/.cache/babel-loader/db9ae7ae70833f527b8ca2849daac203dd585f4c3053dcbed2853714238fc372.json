{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ROG Gamer\\\\Desktop\\\\dyskord\\\\frontend\\\\src\\\\components\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport Sidebar from './Sidebar';\nimport MessageArea from './MessageArea';\nimport { channelsAPI, usersAPI } from '../api';\nimport { authAPI } from '../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Chat({\n  user,\n  onLogout,\n  onUserUpdate\n}) {\n  _s();\n  const [channels, setChannels] = useState([]);\n  const [friends, setFriends] = useState([]);\n  const [allUsers, setAllUsers] = useState([]);\n  const [selectedChannel, setSelectedChannel] = useState(null);\n  const [selectedDM, setSelectedDM] = useState(null);\n  const [socket, setSocket] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // Initialize socket connection\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    const newSocket = io('http://localhost:5000', {\n      auth: {\n        token\n      }\n    });\n    newSocket.on('connect', () => {\n      console.log('Connected to server');\n    });\n    newSocket.on('disconnect', () => {\n      console.log('Disconnected from server');\n    });\n    setSocket(newSocket);\n    return () => {\n      newSocket.close();\n    };\n  }, []);\n\n  // Fetch channels and friends on mount\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const [channelsRes, friendsRes, usersRes] = await Promise.all([channelsAPI.getAll(), usersAPI.getFriends(), usersAPI.getAll()]);\n        setChannels(channelsRes.data);\n        setFriends(friendsRes.data);\n        setAllUsers(usersRes.data);\n\n        // Select first channel if available\n        if (channelsRes.data.length > 0) {\n          setSelectedChannel(channelsRes.data[0].id);\n        }\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, []);\n\n  // Handle channel selection\n  const handleChannelSelect = channelId => {\n    setSelectedChannel(channelId);\n    setSelectedDM(null);\n  };\n\n  // Handle DM selection\n  const handleDMSelect = userId => {\n    setSelectedDM(userId);\n    setSelectedChannel(null);\n  };\n\n  // Handle new channel creation\n  const handleChannelCreate = async (name, description) => {\n    try {\n      const response = await channelsAPI.create(name, description);\n      setChannels([...channels, response.data]);\n      setSelectedChannel(response.data.id);\n      setSelectedDM(null);\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Error creating channel:', error);\n      alert(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Failed to create channel');\n    }\n  };\n\n  // Refresh user data after profile picture update\n  const handleUserUpdate = async () => {\n    try {\n      const response = await authAPI.getMe();\n      onUserUpdate(response.data);\n    } catch (error) {\n      console.error('Error updating user:', error);\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100vh',\n        color: '#dcddde'\n      },\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(Sidebar, {\n      channels: channels,\n      friends: friends,\n      allUsers: allUsers,\n      selectedChannel: selectedChannel,\n      selectedDM: selectedDM,\n      onChannelSelect: handleChannelSelect,\n      onDMSelect: handleDMSelect,\n      onChannelCreate: handleChannelCreate,\n      onLogout: onLogout,\n      user: user,\n      onUserUpdate: handleUserUpdate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MessageArea, {\n      channelId: selectedChannel,\n      dmUserId: selectedDM,\n      socket: socket,\n      currentUser: user\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 117,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"EQVEktcXiJmlwBeap7m33dv3JYQ=\");\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","io","Sidebar","MessageArea","channelsAPI","usersAPI","authAPI","jsxDEV","_jsxDEV","Chat","user","onLogout","onUserUpdate","_s","channels","setChannels","friends","setFriends","allUsers","setAllUsers","selectedChannel","setSelectedChannel","selectedDM","setSelectedDM","socket","setSocket","loading","setLoading","token","localStorage","getItem","newSocket","auth","on","console","log","close","fetchData","channelsRes","friendsRes","usersRes","Promise","all","getAll","getFriends","data","length","id","error","handleChannelSelect","channelId","handleDMSelect","userId","handleChannelCreate","name","description","response","create","_error$response","_error$response$data","alert","handleUserUpdate","getMe","style","display","justifyContent","alignItems","height","color","children","fileName","_jsxFileName","lineNumber","columnNumber","className","onChannelSelect","onDMSelect","onChannelCreate","dmUserId","currentUser","_c","$RefreshReg$"],"sources":["C:/Users/ROG Gamer/Desktop/dyskord/frontend/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport Sidebar from './Sidebar';\r\nimport MessageArea from './MessageArea';\r\nimport { channelsAPI, usersAPI } from '../api';\r\nimport { authAPI } from '../api';\r\n\r\nfunction Chat({ user, onLogout, onUserUpdate }) {\r\n  const [channels, setChannels] = useState([]);\r\n  const [friends, setFriends] = useState([]);\r\n  const [allUsers, setAllUsers] = useState([]);\r\n  const [selectedChannel, setSelectedChannel] = useState(null);\r\n  const [selectedDM, setSelectedDM] = useState(null);\r\n  const [socket, setSocket] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Initialize socket connection\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    const newSocket = io('http://localhost:5000', {\r\n      auth: { token }\r\n    });\r\n\r\n    newSocket.on('connect', () => {\r\n      console.log('Connected to server');\r\n    });\r\n\r\n    newSocket.on('disconnect', () => {\r\n      console.log('Disconnected from server');\r\n    });\r\n\r\n    setSocket(newSocket);\r\n\r\n    return () => {\r\n      newSocket.close();\r\n    };\r\n  }, []);\r\n\r\n  // Fetch channels and friends on mount\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const [channelsRes, friendsRes, usersRes] = await Promise.all([\r\n          channelsAPI.getAll(),\r\n          usersAPI.getFriends(),\r\n          usersAPI.getAll()\r\n        ]);\r\n\r\n        setChannels(channelsRes.data);\r\n        setFriends(friendsRes.data);\r\n        setAllUsers(usersRes.data);\r\n\r\n        // Select first channel if available\r\n        if (channelsRes.data.length > 0) {\r\n          setSelectedChannel(channelsRes.data[0].id);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching data:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  // Handle channel selection\r\n  const handleChannelSelect = (channelId) => {\r\n    setSelectedChannel(channelId);\r\n    setSelectedDM(null);\r\n  };\r\n\r\n  // Handle DM selection\r\n  const handleDMSelect = (userId) => {\r\n    setSelectedDM(userId);\r\n    setSelectedChannel(null);\r\n  };\r\n\r\n  // Handle new channel creation\r\n  const handleChannelCreate = async (name, description) => {\r\n    try {\r\n      const response = await channelsAPI.create(name, description);\r\n      setChannels([...channels, response.data]);\r\n      setSelectedChannel(response.data.id);\r\n      setSelectedDM(null);\r\n    } catch (error) {\r\n      console.error('Error creating channel:', error);\r\n      alert(error.response?.data?.error || 'Failed to create channel');\r\n    }\r\n  };\r\n\r\n  // Refresh user data after profile picture update\r\n  const handleUserUpdate = async () => {\r\n    try {\r\n      const response = await authAPI.getMe();\r\n      onUserUpdate(response.data);\r\n    } catch (error) {\r\n      console.error('Error updating user:', error);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div style={{\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        height: '100vh',\r\n        color: '#dcddde'\r\n      }}>\r\n        Loading...\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"chat-container\">\r\n      <Sidebar\r\n        channels={channels}\r\n        friends={friends}\r\n        allUsers={allUsers}\r\n        selectedChannel={selectedChannel}\r\n        selectedDM={selectedDM}\r\n        onChannelSelect={handleChannelSelect}\r\n        onDMSelect={handleDMSelect}\r\n        onChannelCreate={handleChannelCreate}\r\n        onLogout={onLogout}\r\n        user={user}\r\n        onUserUpdate={handleUserUpdate}\r\n      />\r\n      <MessageArea\r\n        channelId={selectedChannel}\r\n        dmUserId={selectedDM}\r\n        socket={socket}\r\n        currentUser={user}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}